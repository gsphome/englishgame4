var L=Object.defineProperty;var c=(n,a)=>L(n,"name",{value:a,configurable:!0});import{r as m,u as k,a as M,b as T,d as $,j as s,C as q,f as I}from"./index-M6D_uxQG.js";import{u as _}from"./useToast-DWvUtLLM.js";import{u as D}from"./useLearningCleanup-CHNtf5mF.js";import{s as v}from"./randomUtils-7Ip2EMOC.js";import{A as R}from"./arrow-right-C3tj_h2e.js";const P=["span","strong","em","b","i"],B=["class"],H=c(n=>{if(typeof n!="string")return"";let a=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");return a=a.replace(/\s*on\w+\s*=\s*["'][^"']*["']/gi,""),a=a.replace(/javascript:/gi,""),a=a.replace(/data:(?!image\/(?:png|jpg|jpeg|gif|svg\+xml))[^;]*/gi,""),["script","object","embed","link","style","meta","iframe","form","input"].forEach(p=>{const g=new RegExp(`<\\/?${p}\\b[^>]*>`,"gi");a=a.replace(g,"")}),a=a.replace(/<(\w+)([^>]*)>/gi,(p,g,l)=>{if(!P.includes(g.toLowerCase()))return"";const h=l.replace(/(\w+)\s*=\s*["']([^"']*)["']/gi,(j,o,b)=>{if(!B.includes(o.toLowerCase()))return"";if(o.toLowerCase()==="class"){const x=b.replace(/[^a-zA-Z0-9\s\-_]/g,"");return`${o}="${x}"`}return`${o}="${b}"`});return`<${g}${h}>`}),a},"sanitizeHTML"),O=c(n=>({__html:H(n)}),"createSanitizedHTML"),Z=c(({module:n})=>{const[a,w]=m.useState(0),[p,g]=m.useState(null),[l,h]=m.useState(!1),[j]=m.useState(Date.now()),o=m.useMemo(()=>{if(!(n!=null&&n.data))return[];const i=n.data;return v(i).map(r=>{if(!r.options||!r.correct)return r;const d=v([...r.options]);return{...r,options:d}})},[n==null?void 0:n.data]),{updateSessionScore:b,setCurrentView:x}=k(),{updateUserScore:N}=M(),{theme:S}=T(),{addProgressEntry:C}=$(),{showCorrectAnswer:A,showIncorrectAnswer:z,showModuleCompleted:E}=_();D();const f=S==="dark"?"white":"#111827",e=o[a],u=c(i=>{var d;if(l||!e)return;const r=((d=e.options)==null?void 0:d[i])===e.correct;g(i),h(!0),b(r?{correct:1}:{incorrect:1}),r?A():z()},"handleAnswerSelect"),y=c(()=>{if(a<o.length-1)w(a+1),g(null),h(!1);else{const i=Math.floor((Date.now()-j)/1e3),{sessionScore:t}=k.getState(),r=Math.round(t.correct/t.total*100),d=t.accuracy;C({score:r,totalQuestions:t.total,correctAnswers:t.correct,moduleId:n.id,learningMode:"quiz",timeSpent:i}),E(n.name,r,d),N(n.id,r,i),x("menu")}},"handleNext");return m.useEffect(()=>{if(o.length===0)return;const i=c(t=>{var r;if(t.key>="1"&&t.key<="4"&&!l&&e){const d=parseInt(t.key)-1;d<(((r=e.options)==null?void 0:r.length)||0)&&u(d)}else t.key==="Enter"&&l?y():t.key==="Escape"&&x("menu")},"handleKeyPress");return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[l,e,o.length,u,y,x]),o.length?s.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6",children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex justify-between items-center mb-3",children:[s.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:n.name}),s.jsx("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1 rounded-full",style:{minWidth:"60px",textAlign:"center"},children:o.length>0?`${a+1}/${o.length}`:"..."})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"bg-green-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${(a+1)/o.length*100}%`}})}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:l?"Press Enter for next question":"Press 1-4 to select or click an option"})]}),s.jsxs("div",{className:"quiz-question bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-6 mb-4",children:[s.jsx("h3",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6",style:{color:f},children:s.jsx("div",{dangerouslySetInnerHTML:O((e==null?void 0:e.sentence)||"Loading question...")})}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:((e==null?void 0:e.options)||[]).map((i,t)=>{let r="quiz-option w-full p-3 text-left border-2 rounded-lg transition-all duration-200 ";return l?(e==null?void 0:e.options[t])===(e==null?void 0:e.correct)?r+="quiz-option--correct border-green-500 dark:border-green-400 bg-green-50 dark:bg-green-900 text-green-800 dark:!text-white":t===p&&(e==null?void 0:e.options[t])!==(e==null?void 0:e.correct)?r+="quiz-option--incorrect border-red-500 dark:border-red-400 bg-red-50 dark:bg-red-900 text-red-800 dark:!text-white":r+="quiz-option--disabled border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 text-gray-600 dark:!text-white":r+="border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-gray-700 text-gray-900 dark:!text-white",s.jsx("button",{onClick:c(()=>u(t),"onClick"),disabled:l,className:r,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-full flex items-center justify-center text-xs font-medium mr-3",children:t+1}),s.jsx("span",{className:"text-sm",style:{color:f},children:i})]}),l&&s.jsxs("div",{children:[(e==null?void 0:e.options[t])===(e==null?void 0:e.correct)&&s.jsx(q,{className:"h-6 w-6 text-green-600"}),t===p&&(e==null?void 0:e.options[t])!==(e==null?void 0:e.correct)&&s.jsx(I,{className:"h-6 w-6 text-red-600"})]})]})},t)})}),s.jsx("div",{className:`mt-6 overflow-hidden transition-all duration-300 ease-in-out ${l&&(e!=null&&e.explanation)?"max-h-40 opacity-100":"max-h-0 opacity-0"}`,children:s.jsxs("div",{className:"quiz-explanation p-4 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg",children:[s.jsx("h4",{className:"font-medium mb-2",style:{color:f},children:"Explanation:"}),s.jsx("p",{style:{color:f},children:(e==null?void 0:e.explanation)||""})]})})]}),s.jsxs("div",{className:"flex justify-center items-center gap-3 flex-wrap mt-6",children:[l&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[s.jsx("span",{children:a===o.length-1?"Finish Quiz":"Next Question"}),s.jsx(R,{className:"h-4 w-4"})]}),s.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"})]}),s.jsx("button",{onClick:c(()=>x("menu"),"onClick"),className:"flex items-center gap-1 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium",children:"← Menu"})]})]}):s.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6 text-center",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"No quiz questions available"}),s.jsx("button",{onClick:c(()=>x("menu"),"onClick"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Menu"})]})},"QuizComponent");export{Z as default};
