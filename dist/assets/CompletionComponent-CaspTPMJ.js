var q=Object.defineProperty;var c=(s,i)=>q(s,"name",{value:i,configurable:!0});import{r as x,u as C,a as z,b as E,d as K,j as e,e as Q,X as V}from"./index-M6D_uxQG.js";import{u as W}from"./useToast-DWvUtLLM.js";import{u as X}from"./useLearningCleanup-CHNtf5mF.js";import{s as B}from"./randomUtils-7Ip2EMOC.js";import{C as v}from"./check-BwgYgpQD.js";import{A as G}from"./arrow-right-C3tj_h2e.js";const re=c(({module:s})=>{var w,y,j;const[i,S]=x.useState(0),[a,p]=x.useState(""),[n,b]=x.useState(!1),[A]=x.useState(Date.now()),{updateSessionScore:L,setCurrentView:g}=C(),{updateUserScore:M}=z(),{language:$}=E(),{addProgressEntry:I}=K(),{t:f}=Q($),{showCorrectAnswer:_,showIncorrectAnswer:T,showModuleCompleted:P}=W();X();const l=x.useMemo(()=>s!=null&&s.data?B(s.data):[],[s==null?void 0:s.data]),t=l[i];x.useEffect(()=>{if(!n&&l.length>0){const o=document.querySelector('input[type="text"]');o&&setTimeout(()=>o.focus(),100)}},[i,n,l.length]);const h=c(()=>{var m;if(n)return;const o=a.toLowerCase().trim(),r=((m=t==null?void 0:t.correct)==null?void 0:m.toLowerCase().trim())||"",d=o===r;L(d?{correct:1}:{incorrect:1}),b(!0),d?_():T()},"checkAnswer"),u=c(()=>{if(i<l.length-1)S(i+1),p(""),b(!1);else{const o=Math.floor((Date.now()-A)/1e3),{sessionScore:r}=C.getState(),d=Math.round(r.correct/r.total*100);I({score:d,totalQuestions:r.total,correctAnswers:r.correct,moduleId:s.id,learningMode:"completion",timeSpent:o});const m=r.accuracy;P(s.name,d,m),M(s.id,d,o),g("menu")}},"handleNext");if(x.useEffect(()=>{if(l.length===0)return;const o=c(r=>{r.key==="Enter"&&!n?a.trim()&&h():r.key==="Enter"&&n?u():r.key==="Escape"&&g("menu")},"handleKeyPress");return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[a,n,l.length,h,u,g]),!l.length)return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:f("noDataAvailable")||"No completion exercises available"}),e.jsx("button",{onClick:c(()=>g("menu"),"onClick"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:f("navigation.mainMenu")})]});const R=c(()=>{if(!(t!=null&&t.sentence))return null;const o=t.sentence.split("______"),r=[];return o.forEach((d,m)=>{var k;if(d&&r.push(e.jsx("span",{className:"text-gray-900 dark:text-white",children:d},`text-${m}`)),m<o.length-1){const N=n&&a.toLowerCase().trim()===((k=t.correct)==null?void 0:k.toLowerCase().trim()),F=n&&a&&!N;r.push(e.jsx("input",{type:"text",value:a,onChange:c(U=>p(U.target.value),"onChange"),disabled:n,placeholder:"...",autoComplete:"off",className:`inline-block mx-2 px-3 py-1.5 min-w-[120px] text-center rounded-lg border-2 focus:outline-none transition-all duration-200 font-medium ${n?N?"border-green-500 bg-green-50 text-green-700 dark:bg-green-900 dark:text-green-200":F?"border-red-500 bg-red-50 text-red-700 dark:bg-red-900 dark:text-red-200":"border-gray-300 bg-gray-50 text-gray-600 dark:bg-gray-700 dark:text-gray-300":"border-blue-300 bg-blue-50 focus:border-blue-500 focus:bg-white text-gray-900 dark:bg-gray-700 dark:border-gray-500 dark:text-white dark:focus:bg-gray-600"}`,style:{width:`${Math.max(120,((a==null?void 0:a.length)||3)*12+60)}px`}},`input-${m}`))}}),e.jsx(e.Fragment,{children:r})},"renderSentence"),D=a.trim().length>0;return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:s.name}),e.jsx("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1 rounded-full",style:{minWidth:"60px",textAlign:"center"},children:l.length>0?`${i+1}/${l.length}`:"..."})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-purple-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${(i+1)/l.length*100}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:n?"Press Enter for next exercise":"Fill the blank and press Enter"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 sm:p-6 mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Complete the sentence:"}),(t==null?void 0:t.tip)&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 border-l-4 border-blue-400 rounded-r-lg",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["üí° ",e.jsx("strong",{children:"Tip:"})," ",t.tip]})}),e.jsx("div",{className:"text-lg leading-relaxed mb-4 p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl border border-gray-200 dark:border-gray-600 shadow-inner",children:e.jsx("div",{className:"text-gray-900 dark:text-white font-medium",children:R()})}),e.jsx("div",{className:`mt-3 overflow-hidden transition-all duration-300 ease-in-out ${n?"max-h-32 opacity-100":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"px-3 py-2 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-1.5 flex-wrap",children:[a.toLowerCase().trim()===((w=t==null?void 0:t.correct)==null?void 0:w.toLowerCase().trim())?e.jsx(v,{className:"h-3.5 w-3.5 text-green-600"}):e.jsx(V,{className:"h-3.5 w-3.5 text-red-600"}),e.jsx("span",{className:"font-medium text-xs text-gray-900 dark:text-white",children:a.toLowerCase().trim()===((y=t==null?void 0:t.correct)==null?void 0:y.toLowerCase().trim())?"Correct!":"Incorrect"}),a.toLowerCase().trim()!==((j=t==null?void 0:t.correct)==null?void 0:j.toLowerCase().trim())&&e.jsxs("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:["- Answer: ",e.jsx("strong",{children:t==null?void 0:t.correct})]})]}),(t==null?void 0:t.explanation)&&e.jsx("div",{className:"border-t border-blue-200 dark:border-blue-700 pt-2 mt-2",children:e.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-300 leading-relaxed",children:[e.jsx("span",{className:"font-medium",children:"Explanation:"})," ",t.explanation]})})]})})]}),e.jsxs("div",{className:"flex justify-center items-center gap-3 flex-wrap mt-6",children:[n?e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[e.jsx("span",{children:i===l.length-1?"Finish":"Next"}),e.jsx(G,{className:"h-4 w-4"})]}):e.jsxs("button",{onClick:h,disabled:!D,className:"flex items-center gap-2 px-6 py-2.5 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:"Check Answer"})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:c(()=>g("menu"),"onClick"),className:"flex items-center gap-1 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium",children:"‚Üê Menu"})]})]})},"CompletionComponent");export{re as default};
