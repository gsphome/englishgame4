var H=Object.defineProperty;var a=(n,m)=>H(n,"name",{value:m,configurable:!0});import{r as x,u as J,a as Q,j as e,I as W,X as Y}from"./index-M6D_uxQG.js";import{u as Z}from"./useToast-DWvUtLLM.js";import{u as ee}from"./useLearningCleanup-CHNtf5mF.js";import{R as te}from"./rotate-ccw-C5YwKoAy.js";import{C as se}from"./check-BwgYgpQD.js";const de=a(({module:n})=>{const[m,C]=x.useState([]),[S,E]=x.useState([]),[p,u]=x.useState(null),[k,b]=x.useState(null),[c,y]=x.useState({}),[h,v]=x.useState(!1),[O]=x.useState(Date.now()),[N,j]=x.useState(!1),[f,$]=x.useState(null),M=x.useRef(null),{updateSessionScore:D,setCurrentView:w}=J(),{updateUserScore:P}=Q(),{showCorrectAnswer:T,showIncorrectAnswer:_,showModuleCompleted:F}=Z();if(ee(),x.useEffect(()=>{const t=a(s=>{N?(s.key==="Enter"||s.key==="Escape")&&j(!1):s.key==="Escape"&&w("menu")},"handleKeyPress");return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[N,w]),x.useEffect(()=>{if(!(n!=null&&n.data)||!(n!=null&&n.id)||M.current===n.id)return;M.current=n.id;let t=[];const s=n.data[0];if(s!=null&&s.pairs?t=s.pairs:Array.isArray(n.data)&&(t=n.data.map(r=>({left:r.en||r.term||r.left||"",right:r.es||r.definition||r.right||""}))),t.length>0){const r=t.map(o=>o.left).sort(()=>Math.random()-.5),d=t.map(o=>o.right).sort(()=>Math.random()-.5);C(r),E(d),y({}),u(null),b(null),v(!1)}},[n==null?void 0:n.data,n==null?void 0:n.id]),!(n!=null&&n.data)||m.length===0)return e.jsx("div",{className:"max-w-6xl mx-auto p-6 text-center",children:e.jsx("p",{className:"text-gray-600 mb-4",children:"Loading matching exercise..."})});const l=a(()=>{if(!n.data)return[];const t=n.data[0];return t!=null&&t.pairs?t.pairs:n.data.map(s=>({left:s.term||"",right:s.definition||""}))},"getPairs")(),U=a(t=>{h||c[t]||(p===t?u(null):(u(t),k&&L(t,k)))},"handleLeftClick"),z=a(t=>{h||Object.values(c).includes(t)||(k===t?b(null):(b(t),p&&L(p,t)))},"handleRightClick"),L=a((t,s)=>{y(r=>({...r,[t]:s})),u(null),b(null)},"createMatch"),K=a(t=>{h||y(s=>{const r={...s};return delete r[t],r})},"removeMatch"),V=a(()=>{let t=0;l.forEach(r=>{c[r.left]===r.right&&t++});const s=t===l.length;D(s?{correct:1}:{incorrect:1}),v(!0),s?T():_()},"checkAnswers"),X=a(()=>{const t=l.map(r=>r.left).sort(()=>Math.random()-.5),s=l.map(r=>r.right).sort(()=>Math.random()-.5);C(t),E(s),y({}),u(null),b(null),v(!1)},"resetExercise"),q=a(()=>{const t=Math.floor((Date.now()-O)/1e3),s=l.filter(o=>c[o.left]===o.right).length,r=Math.round(s/l.length*100),d=s/l.length*100;F(n.name,r,d),P(n.id,r,t),w("menu")},"finishExercise"),R=Object.keys(c).length===l.length,A=a((t,s)=>{var r;if(h)if(s){const d=(r=l.find(i=>i.left===t))==null?void 0:r.right;return c[t]===d?"correct":"incorrect"}else{const d=l.find(i=>i.right===t),o=Object.entries(c).find(([i,g])=>g===t);return d&&o?o[0]===d.left?"correct":"incorrect":Object.values(c).includes(t)?"incorrect":"unmatched"}return"normal"},"getItemStatus");return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:n.name}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:[Object.keys(c).length,"/",l.length," matched"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-pink-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${Object.keys(c).length/l.length*100}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:R?"All matched! Check your answers":"Click items from both columns to match them"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center",children:"Terms"}),m.map((t,s)=>{const r=c[t],d=p===t,o=A(t,!0);let i="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 font-medium ";return h?i+=o==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":r?i+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 cursor-pointer":d?i+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":i+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:a(()=>r?K(t):U(t),"onClick"),className:i,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+s)}),e.jsx("span",{className:"truncate flex-1",children:t}),e.jsxs("div",{className:"flex items-center space-x-1",children:[h&&e.jsx("div",{onClick:a(g=>{var I;g.stopPropagation();const B=(I=n.data)==null?void 0:I.find(G=>G.term===t);$(B),j(!0)},"onClick"),className:"flex-shrink-0 w-5 h-5 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center transition-colors cursor-pointer",title:"Show explanation",children:e.jsx(W,{className:"h-3 w-3"})}),r&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-pink-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:S.findIndex(g=>c[t]===g)+1})]})]})},`left-${s}`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center",children:"Definitions"}),S.map((t,s)=>{const r=Object.values(c).includes(t),d=k===t,o=A(t,!1);let i="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 ";return h?i+=o==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":o==="incorrect"?"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400":r?i+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 opacity-60":d?i+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":i+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:a(()=>z(t),"onClick"),disabled:r,className:i,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-orange-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:s+1}),e.jsx("span",{className:"truncate flex-1",children:t}),r&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+m.findIndex(g=>c[g]===t))})]})},`right-${s}`)})]})]}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full",children:[e.jsx("div",{className:"flex space-x-1",children:Array.from({length:l.length}).map((t,s)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${s<Object.keys(c).length?"bg-pink-500":"bg-gray-300 dark:bg-gray-600"}`},s))}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-2",children:h?`${l.filter(t=>c[t.left]===t.right).length}/${l.length} correct`:`${Object.keys(c).length}/${l.length}`})]})})]}),e.jsxs("div",{className:"flex justify-center items-center gap-3 flex-wrap mt-6",children:[h?e.jsx("button",{onClick:q,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:e.jsx("span",{children:"Finish Exercise"})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:X,className:"p-2.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors shadow-sm",title:"Reset Exercise",children:e.jsx(te,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:V,disabled:!R,className:"flex items-center gap-2 px-6 py-2.5 bg-pink-600 hover:bg-pink-700 disabled:bg-gray-400 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Check Matches"})]})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:a(()=>w("menu"),"onClick"),className:"flex items-center gap-1 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium",children:"← Menu"})]}),N&&f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-black dark:bg-opacity-80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:!bg-slate-800 border-0 dark:border dark:!border-slate-600 rounded-xl shadow-2xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:f.term}),e.jsx("button",{onClick:a(()=>j(!1),"onClick"),className:"text-gray-400 hover:text-gray-600 transition-colors",style:{color:document.documentElement.classList.contains("dark")?"#d1d5db":void 0},children:e.jsx(Y,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Definition:"}),e.jsx("p",{className:"text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:f.definition})]}),f.explanation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Explanation:"}),e.jsx("p",{className:"text-gray-600 text-sm",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:f.explanation})]}),f.term_es&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Spanish:"}),e.jsx("p",{className:"text-gray-900 font-medium",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:f.term_es})]})]}),e.jsx("button",{onClick:a(()=>j(!1),"onClick"),className:"w-full mt-6 px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:!bg-blue-600 dark:hover:!bg-blue-500 text-white rounded-lg transition-colors",children:"Close"})]})})})]})},"MatchingComponent");export{de as default};
