import{r as d,u as G,a as H,j as e,I as J,X as Q}from"./index-J5Xyvgle.js";import{u as W}from"./useToast-D_Q5j2Xp.js";import{u as Y}from"./useLearningCleanup-ByTJO6CK.js";import{R as Z}from"./rotate-ccw-Coa9FHcv.js";import{C as ee}from"./check-DewPAQjC.js";const le=({module:n})=>{const[j,N]=d.useState([]),[C,S]=d.useState([]),[u,f]=d.useState(null),[b,g]=d.useState(null),[a,p]=d.useState({}),[x,w]=d.useState(!1),[I]=d.useState(Date.now()),[v,k]=d.useState(!1),[h,O]=d.useState(null),E=d.useRef(null),{updateSessionScore:$,setCurrentView:y}=G(),{updateUserScore:D}=H(),{showCorrectAnswer:P,showIncorrectAnswer:T,showModuleCompleted:_}=W();if(Y(),d.useEffect(()=>{const t=s=>{v?(s.key==="Enter"||s.key==="Escape")&&k(!1):s.key==="Escape"&&y("menu")};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[v,y]),d.useEffect(()=>{if(!(n!=null&&n.data)||!(n!=null&&n.id)||E.current===n.id)return;E.current=n.id;let t=[];const s=n.data[0];if(s!=null&&s.pairs?t=s.pairs:Array.isArray(n.data)&&(t=n.data.map(r=>({left:r.en||r.term||r.left||"",right:r.es||r.definition||r.right||""}))),t.length>0){const r=t.map(i=>i.left).sort(()=>Math.random()-.5),o=t.map(i=>i.right).sort(()=>Math.random()-.5);N(r),S(o),p({}),f(null),g(null),w(!1)}},[n==null?void 0:n.data,n==null?void 0:n.id]),!(n!=null&&n.data)||j.length===0)return e.jsx("div",{className:"max-w-6xl mx-auto p-6 text-center",children:e.jsx("p",{className:"text-gray-600 mb-4",children:"Loading matching exercise..."})});const l=(()=>{if(!n.data)return[];const t=n.data[0];return t!=null&&t.pairs?t.pairs:n.data.map(s=>({left:s.term||"",right:s.definition||""}))})(),F=t=>{x||a[t]||(u===t?f(null):(f(t),b&&M(t,b)))},U=t=>{x||Object.values(a).includes(t)||(b===t?g(null):(g(t),u&&M(u,t)))},M=(t,s)=>{p(r=>({...r,[t]:s})),f(null),g(null)},z=t=>{x||p(s=>{const r={...s};return delete r[t],r})},K=()=>{let t=0;l.forEach(r=>{a[r.left]===r.right&&t++});const s=t===l.length;$(s?{correct:1}:{incorrect:1}),w(!0),s?P():T()},V=()=>{const t=l.map(r=>r.left).sort(()=>Math.random()-.5),s=l.map(r=>r.right).sort(()=>Math.random()-.5);N(t),S(s),p({}),f(null),g(null),w(!1)},X=()=>{const t=Math.floor((Date.now()-I)/1e3),s=l.filter(i=>a[i.left]===i.right).length,r=Math.round(s/l.length*100),o=s/l.length*100;_(n.name,r,o),D(n.id,r,t),y("menu")},L=Object.keys(a).length===l.length,R=(t,s)=>{var r;if(x)if(s){const o=(r=l.find(c=>c.left===t))==null?void 0:r.right;return a[t]===o?"correct":"incorrect"}else{const o=l.find(c=>c.right===t),i=Object.entries(a).find(([,c])=>c===t);return o&&i?i[0]===o.left?"correct":"incorrect":Object.values(a).includes(t)?"incorrect":"unmatched"}return"normal"};return e.jsxs("div",{className:"max-w-6xl mx-auto p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:n.name}),e.jsxs("span",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-3 py-1 rounded-full",children:[Object.keys(a).length,"/",l.length," matched"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-pink-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${Object.keys(a).length/l.length*100}%`}})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:L?"All matched! Check your answers":"Click items from both columns to match them"})]}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center",children:"Terms"}),j.map((t,s)=>{const r=a[t],o=u===t,i=R(t,!0);let c="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 font-medium ";return x?c+=i==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":r?c+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 cursor-pointer":o?c+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":c+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:()=>r?z(t):F(t),className:c,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+s)}),e.jsx("span",{className:"truncate flex-1",children:t}),e.jsxs("div",{className:"flex items-center space-x-1",children:[x&&e.jsx("div",{onClick:m=>{var A;m.stopPropagation();const q=(A=n.data)==null?void 0:A.find(B=>B.term===t);O(q),k(!0)},className:"flex-shrink-0 w-5 h-5 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center transition-colors cursor-pointer",title:"Show explanation",children:e.jsx(J,{className:"h-3 w-3"})}),r&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-pink-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:C.findIndex(m=>a[t]===m)+1})]})]})},`left-${s}`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 text-center",children:"Definitions"}),C.map((t,s)=>{const r=Object.values(a).includes(t),o=b===t,i=R(t,!1);let c="w-full p-3 text-sm text-left border-2 rounded-xl transition-all duration-200 ";return x?c+=i==="correct"?"border-green-400 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":i==="incorrect"?"border-red-400 bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200":"border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400":r?c+="border-pink-400 bg-pink-100 dark:bg-pink-900 text-pink-800 dark:text-pink-200 opacity-60":o?c+="border-pink-500 bg-pink-200 dark:bg-pink-800 text-pink-900 dark:text-pink-100 shadow-md scale-105":c+="border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:border-pink-300 hover:bg-pink-50 dark:hover:bg-pink-900 cursor-pointer hover:shadow-md hover:scale-102",e.jsx("button",{onClick:()=>U(t),disabled:r,className:c,children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-orange-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:s+1}),e.jsx("span",{className:"truncate flex-1",children:t}),r&&e.jsx("span",{className:"flex-shrink-0 w-6 h-6 bg-blue-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:String.fromCharCode(65+j.findIndex(m=>a[m]===t))})]})},`right-${s}`)})]})]}),e.jsx("div",{className:"text-center mb-6",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-full",children:[e.jsx("div",{className:"flex space-x-1",children:Array.from({length:l.length}).map((t,s)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${s<Object.keys(a).length?"bg-pink-500":"bg-gray-300 dark:bg-gray-600"}`},s))}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400 ml-2",children:x?`${l.filter(t=>a[t.left]===t.right).length}/${l.length} correct`:`${Object.keys(a).length}/${l.length}`})]})})]}),e.jsxs("div",{className:"flex justify-center items-center gap-3 flex-wrap mt-6",children:[x?e.jsx("button",{onClick:X,className:"flex items-center gap-2 px-6 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:e.jsx("span",{children:"Finish Exercise"})}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:V,className:"p-2.5 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors shadow-sm",title:"Reset Exercise",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsxs("button",{onClick:K,disabled:!L,className:"flex items-center gap-2 px-6 py-2.5 bg-pink-600 hover:bg-pink-700 disabled:bg-gray-400 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Check Matches"})]})]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-1"}),e.jsx("button",{onClick:()=>y("menu"),className:"flex items-center gap-1 px-4 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium",children:"← Menu"})]}),v&&h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 dark:bg-black dark:bg-opacity-80 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white dark:!bg-slate-800 border-0 dark:border dark:!border-slate-600 rounded-xl shadow-2xl max-w-md w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:h.term}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",style:{color:document.documentElement.classList.contains("dark")?"#d1d5db":void 0},children:e.jsx(Q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Definition:"}),e.jsx("p",{className:"text-gray-900",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:h.definition})]}),h.explanation&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Explanation:"}),e.jsx("p",{className:"text-gray-600 text-sm",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:h.explanation})]}),h.term_es&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-1",style:{color:document.documentElement.classList.contains("dark")?"#e5e7eb":void 0},children:"Spanish:"}),e.jsx("p",{className:"text-gray-900 font-medium",style:{color:document.documentElement.classList.contains("dark")?"#ffffff":void 0},children:h.term_es})]})]}),e.jsx("button",{onClick:()=>k(!1),className:"w-full mt-6 px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:!bg-blue-600 dark:hover:!bg-blue-500 text-white rounded-lg transition-colors",children:"Close"})]})})})]})};export{le as default};
